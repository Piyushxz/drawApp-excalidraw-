(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[250],{90178:(e,t,s)=>{Promise.resolve().then(s.bind(s,4360))},4360:(e,t,s)=>{"use strict";s.d(t,{default:()=>ew});var i=s(36694),a=s(83286);let o="ws://13.235.113.13:8080";var r=s(52354);function n(e){return(0,i.jsx)("div",{onClick:e.onClick,className:"p-3 rounded-lg ".concat("circle"===e.selectedTool?" border border-gray-600 ":" hover:bg-gray-600/30"," "),children:(0,i.jsx)(r.A,{className:"text-white size-4"})})}var l=s(40495);function d(e){return(0,i.jsx)("div",{onClick:e.onClick,className:"p-3 rounded-lg ".concat("pencil"===e.selectedTool?" border border-gray-600":" hover:bg-gray-600/30"," "),children:(0,i.jsx)(l.A,{className:"text-white size-4"})})}var h=s(63582);function c(e){return(0,i.jsx)("div",{onClick:e.onClick,className:"p-3 rounded-lg ".concat("rect"===e.selectedTool?" border border-gray-600":" hover:bg-gray-600/30"," "),children:(0,i.jsx)(h.A,{className:"text-white size-4"})})}function x(e){return(0,i.jsx)("div",{onClick:e.onClick,className:"p-2 rounded-lg ".concat("diamond"===e.selectedTool?" border border-gray-600 ":" hover:bg-gray-600/30"," "),children:(0,i.jsx)("svg",{className:"size-6",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#F7F7F7","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:(0,i.jsx)("path",{d:"M2.7 10.3a2.41 2.41 0 0 0 0 3.41l7.59 7.59a2.41 2.41 0 0 0 3.41 0l7.59-7.59a2.41 2.41 0 0 0 0-3.41l-7.59-7.59a2.41 2.41 0 0 0-3.41 0Z"})})})}let u=e=>(0,i.jsx)("div",{onClick:e.onClick,className:"p-2 rounded-lg ".concat("line"===e.selectedTool?" border border-gray-600 ":" hover:bg-gray-600/30"," "),children:(0,i.jsx)("svg",{className:"size-6",xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#F7F7F7","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",children:(0,i.jsx)("path",{d:"M5 12h14"})})}),p=e=>(0,i.jsx)("div",{onClick:e.onClick,className:"p-3 rounded-lg ".concat("arrow"===e.selectedTool?" border border-gray-600 ":""," hover:bg-gray-600/30"),children:(0,i.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"#F7F7F7","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",className:"lucide lucide-move-right size-4",children:[(0,i.jsx)("path",{d:"M18 8L22 12L18 16"}),(0,i.jsx)("path",{d:"M2 12H22"})]})});var m=s(246);let g=e=>(0,i.jsx)("div",{onClick:e.onClick,className:"p-3 rounded-lg ".concat("eraser"===e.selectedTool?" border border-gray-600 ":" hover:bg-gray-600/30"," "),children:(0,i.jsx)(m.A,{className:"text-white size-4"})});var v=s(1457);let y=e=>(0,i.jsx)("div",{onClick:e.onClick,className:"p-3 rounded-lg ".concat("mouse"===e.selectedTool?" border border-gray-600 ":""," hover:bg-gray-600/30"),children:(0,i.jsx)(v.A,{className:"text-white size-4"})});var f=s(44851);let k=e=>(0,i.jsx)("div",{onClick:e.onClick,className:"p-3 rounded-lg ".concat("hand"===e.selectedTool?" border border-gray-600 ":""," hover:bg-gray-600/30"),children:(0,i.jsx)(f.A,{className:"text-white size-4"})});var b=s(52413);let w=e=>(0,i.jsx)("div",{onClick:e.onClick,className:"p-3 rounded-lg ".concat("text"===e.selectedTool?" border border-gray-600 ":""," hover:bg-gray-600/30"),children:(0,i.jsx)(b.A,{className:"text-white size-4"})});function S(e){let{selectedTool:t,setSelectedTool:s}=e;return(0,i.jsx)("div",{className:"w-screen  flex justify-center",children:(0,i.jsxs)("div",{className:"fixed py-1 translate-y-4 bg-[#191919] rounded-lg shadow-lg px-2 border border-gray-600/30 flex items-center gap-1.5",children:[(0,i.jsx)(k,{selectedTool:t,size:"lg",onClick:()=>s("hand")}),(0,i.jsx)(y,{selectedTool:t,size:"lg",onClick:()=>s("mouse")}),(0,i.jsx)("div",{className:"h-8 border border-white/15"}),(0,i.jsx)(c,{selectedTool:t,size:"lg",onClick:()=>s("rect")}),(0,i.jsx)(n,{selectedTool:t,size:"lg",onClick:()=>s("circle")}),(0,i.jsx)(d,{selectedTool:t,size:"lg",onClick:()=>s("pencil")}),(0,i.jsx)(x,{selectedTool:t,size:"lg",onClick:()=>s("diamond")}),(0,i.jsx)(u,{selectedTool:t,size:"lg",onClick:()=>s("line")}),(0,i.jsx)(p,{selectedTool:t,size:"lg",onClick:()=>s("arrow")}),(0,i.jsx)(w,{selectedTool:t,size:"lg",onClick:()=>s("text")}),(0,i.jsx)("div",{className:"h-8 border border-white/15"}),(0,i.jsx)(g,{selectedTool:t,size:"lg",onClick:()=>s("eraser")})]})})}var j=s(18900);async function C(e){let t=(await j.A.get("".concat("http://13.235.113.13:3008","/chats/").concat(e))).data.chats;return console.log("response",t),t.map(e=>{let{id:t,message:s}=e,i=JSON.parse(s);return{id:t,shape:i.shape,color:(null==i?void 0:i.color)||"#ffffff",strokeWidth:(null==i?void 0:i.strokeWidth)||2}})}function I(e,t,s,i,a,o){let r,n,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:5,d=a-s,h=o-i,c=d*d+h*h,x=0!==c?((e-s)*d+(t-i)*h)/c:-1;x<0?(r=s,n=i):x>1?(r=a,n=o):(r=s+x*d,n=i+x*h);let u=e-r,p=t-n;return Math.sqrt(u*u+p*p)<=l}class N{updateTransform(e,t){this.zoom=e,this.panOffset=t}setTheme(e){this.isDarkTheme="dark"===e||"system"===e&&window.matchMedia("(prefers-color-scheme: dark)").matches,this.renderCanvas()}notifyCanvasUpdate(){this.onCanvasUpdate&&this.onCanvasUpdate()}setFont(e){switch(e){case"handwriting":default:this.currentFont="Virgil";break;case"code":this.currentFont="Comic Sans MS";break;case"normal":this.currentFont="Satoshi"}this.renderCanvas()}setFontSize(e){this.fontSize=e,this.renderCanvas()}screenToCanvas(e,t){let s=this.zoom/100;return{x:(e-this.panOffset.x)/s,y:(t-this.panOffset.y)/s}}canvasToScreen(e,t){let s=this.zoom/100;return{x:e*s+this.panOffset.x,y:t*s+this.panOffset.y}}updateShapeColor(e,t){let s=this.existingShapes.find(t=>t.id===e);s&&(s.color=t,console.log("shape",s)),this.renderCanvas(),this.notifyCanvasUpdate(),this.socket.send(JSON.stringify({type:"update_shape_color",id:e,shape:s,color:t,roomId:this.roomId,sentBy:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImI0Y2Q4ZWM3LTM1NWUtNGZlYy04YzNiLWIwYzUyYmU1MTFlMCIsImlhdCI6MTc1MzgwNjQ1NH0.bER-qZ5Lvk39mxILYj8O09aIjFeA5x8A1mST4dLyu7I"}))}updateText(e,t,s){let i=this.existingShapes.find(t=>t.id===e);if(i&&"text"===i.shape.type){let e=i.shape;e.fontSize=t,e.fontFamily=s,console.log("shape",i)}this.renderCanvas(),this.notifyCanvasUpdate(),this.socket.send(JSON.stringify({type:"update_shape_text",id:e,shape:i,roomId:this.roomId,sentBy:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImI0Y2Q4ZWM3LTM1NWUtNGZlYy04YzNiLWIwYzUyYmU1MTFlMCIsImlhdCI6MTc1MzgwNjQ1NH0.bER-qZ5Lvk39mxILYj8O09aIjFeA5x8A1mST4dLyu7I"}))}updateShapeStrokeWidth(e,t){let s=this.existingShapes.find(t=>t.id===e);s&&(s.strokeWidth=t,console.log("shape",s)),this.renderCanvas(),this.notifyCanvasUpdate(),this.socket.send(JSON.stringify({type:"update_shape_stroke_width",id:e,shape:s,strokeWidth:t,roomId:this.roomId,sentBy:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImI0Y2Q4ZWM3LTM1NWUtNGZlYy04YzNiLWIwYzUyYmU1MTFlMCIsImlhdCI6MTc1MzgwNjQ1NH0.bER-qZ5Lvk39mxILYj8O09aIjFeA5x8A1mST4dLyu7I"}))}drawSelectionBox(){if(!this.clickedShape)return;let e=this.getSelectionBoxBounds();if(!e)return;let t=e.maxX-e.minX,s=e.maxY-e.minY;this.ctx.strokeStyle="#0096FF",this.ctx.lineWidth=1,this.ctx.setLineDash([4,4]),this.ctx.strokeRect(e.minX,e.minY,t,s),this.ctx.setLineDash([]),this.drawResizeHandles(e.minX,e.minY,t,s)}drawResizeHandles(e,t,s,i){this.ctx.fillStyle="#ffffff",this.ctx.strokeStyle="#0096FF",this.ctx.lineWidth=1.5,[{x:e-2,y:t-2},{x:e+s-6+2,y:t-2},{x:e+s-6+2,y:t+i-6+2},{x:e-2,y:t+i-6+2}].forEach(e=>{this.ctx.beginPath(),this.ctx.roundRect(e.x,e.y,6,6,2),this.ctx.fill(),this.ctx.stroke()})}drawRoundedRect(e,t,s,i){let a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:8,o=s<0?e+s:e,r=i<0?t+i:t,n=Math.abs(s),l=Math.abs(i),d=Math.min(a,Math.min(n,l)/2);this.ctx.beginPath(),this.ctx.moveTo(o+d,r),this.ctx.lineTo(o+n-d,r),this.ctx.quadraticCurveTo(o+n,r,o+n,r+d),this.ctx.lineTo(o+n,r+l-d),this.ctx.quadraticCurveTo(o+n,r+l,o+n-d,r+l),this.ctx.lineTo(o+d,r+l),this.ctx.quadraticCurveTo(o,r+l,o,r+l-d),this.ctx.lineTo(o,r+d),this.ctx.quadraticCurveTo(o,r,o+d,r),this.ctx.closePath(),this.ctx.stroke()}drawPreview(){this.ctx.save(),this.ctx.translate(this.panOffset.x,this.panOffset.y),this.ctx.scale(this.zoom/100,this.zoom/100),this.ctx.strokeStyle=this.isDarkTheme?"rgba(255, 255, 255)":"rgba(0, 0, 0)",this.ctx.lineWidth=1;let e=this.selectedTool,t=this.currentMouseX-this.startX,s=this.currentMouseY-this.startY;if("rect"===e)this.drawRoundedRect(this.startX,this.startY,t,s);else if("circle"===e){let e=this.startX+t/2,i=this.startY+s/2,a=Math.abs(t)/2,o=Math.abs(s)/2;this.ctx.beginPath(),this.ctx.ellipse(e,i,a,o,0,0,2*Math.PI),this.ctx.stroke(),this.ctx.closePath()}else if("pencil"===e){this.ctx.beginPath();for(let e=0;e<this.pencilPath.length-1;e++)this.ctx.moveTo(this.pencilPath[e].x,this.pencilPath[e].y),this.ctx.lineTo(this.pencilPath[e+1].x,this.pencilPath[e+1].y);this.ctx.lineWidth=2,this.ctx.stroke(),this.ctx.closePath()}else if("diamond"===e){let e=this.startX+t/2,i=this.startY+s/2,a=this.startY,o=this.startX+t,r=this.startY+s,n=this.startX;this.ctx.beginPath(),this.ctx.moveTo(e,a),this.ctx.lineTo(o,i),this.ctx.lineTo(e,r),this.ctx.lineTo(n,i),this.ctx.closePath(),this.ctx.stroke()}else if("line"===e)this.ctx.beginPath(),this.ctx.moveTo(this.startX,this.startY),this.ctx.lineTo(this.currentMouseX,this.currentMouseY),this.ctx.stroke();else if("arrow"===e){let e=Math.atan2(this.currentMouseY-this.startY,this.currentMouseX-this.startX);this.ctx.beginPath(),this.ctx.lineCap="round",this.ctx.lineWidth=2.5,this.ctx.moveTo(this.startX,this.startY),this.ctx.lineTo(this.currentMouseX,this.currentMouseY);let t=this.currentMouseX-14*Math.cos(e-Math.PI/6),s=this.currentMouseY-14*Math.sin(e-Math.PI/6),i=this.currentMouseX-14*Math.cos(e+Math.PI/6),a=this.currentMouseY-14*Math.sin(e+Math.PI/6);this.ctx.moveTo(this.currentMouseX,this.currentMouseY),this.ctx.lineTo(t,s),this.ctx.moveTo(this.currentMouseX,this.currentMouseY),this.ctx.lineTo(i,a),this.ctx.stroke()}this.ctx.restore()}destroy(){this.canvas.removeEventListener("mousedown",this.mouseDownHandler),this.canvas.removeEventListener("mouseup",this.mouseUpHandler),this.canvas.removeEventListener("mousemove",this.mouseMoveHandler)}setTool(e){this.selectedTool=e,"arrow"!==this.selectedTool&&(this.clickedShape=void 0,this.clickedShapeIndex=-1),this.updateCursor()}getSelectionBoxBounds(){if(!this.clickedShape)return null;let e=this.clickedShape.shape;if("rect"===e.type){let t=e.width<0?e.x+e.width:e.x,s=e.height<0?e.y+e.height:e.y;return{minX:t-8,minY:s-8,maxX:t+Math.abs(e.width)+8,maxY:s+Math.abs(e.height)+8}}if("circle"===e.type){var t,s,i,a;let o=Math.abs(null!==(s=null!==(t=e.radiusX)&&void 0!==t?t:e.radius)&&void 0!==s?s:0),r=Math.abs(null!==(a=null!==(i=e.radiusY)&&void 0!==i?i:e.radius)&&void 0!==a?a:0);return{minX:e.centerX-o-8,minY:e.centerY-r-8,maxX:e.centerX+o+8,maxY:e.centerY+r+8}}if("diamond"===e.type)return{minX:Math.min(e.x1,e.x2,e.x3,e.x4)-8,minY:Math.min(e.y1,e.y2,e.y3,e.y4)-8,maxX:Math.max(e.x1,e.x2,e.x3,e.x4)+8,maxY:Math.max(e.y1,e.y2,e.y3,e.y4)+8};if("line"===e.type||"arrow"===e.type)return{minX:Math.min(e.x1,e.x2)-8,minY:Math.min(e.y1,e.y2)-8,maxX:Math.max(e.x1,e.x2)+8,maxY:Math.max(e.y1,e.y2)+8};if("pencil"===e.type){if(e.points.length>0)return{minX:Math.min(...e.points.map(e=>e.x))-8,minY:Math.min(...e.points.map(e=>e.y))-8,maxX:Math.max(...e.points.map(e=>e.x))+8,maxY:Math.max(...e.points.map(e=>e.y))+8}}else if("text"===e.type){this.ctx.font="".concat(e.fontSize,"px ").concat(e.fontFamily,", sans-serif");let t=this.ctx.measureText(e.text).width,s=e.fontSize;return{minX:e.x-8,minY:e.y-8,maxX:e.x+t+8,maxY:e.y+s+8}}return null}getResizeHandle(e,t){if(!this.clickedShape)return"";let s=this.getSelectionBoxBounds();return s?e>=s.maxX-6-2&&e<=s.maxX+2&&t>=s.maxY-6-2&&t<=s.maxY+2?"se":e>=s.minX-2&&e<=s.minX+6+2&&t>=s.maxY-6-2&&t<=s.maxY+2?"sw":e>=s.maxX-6-2&&e<=s.maxX+2&&t>=s.minY-2&&t<=s.minY+6+2?"ne":e>=s.minX-2&&e<=s.minX+6+2&&t>=s.minY-2&&t<=s.minY+6+2?"nw":"":""}updateCursor(){if(this.canvas){if(this.isResizing){this.canvas.style.cursor="nw-resize";return}if(this.isDragging&&"mouse"===this.selectedTool){this.canvas.style.cursor="grabbing";return}if("mouse"===this.selectedTool&&this.clickedShape){let e=this.getResizeHandle(this.currentMouseX,this.currentMouseY);if(e){switch(e){case"nw":case"se":this.canvas.style.cursor="nw-resize";break;case"ne":case"sw":this.canvas.style.cursor="ne-resize";break;case"n":case"s":this.canvas.style.cursor="ns-resize";break;case"e":case"w":this.canvas.style.cursor="ew-resize"}return}}switch(this.selectedTool){case"rect":case"circle":case"diamond":case"line":case"arrow":case"pencil":this.canvas.style.cursor="crosshair";break;case"eraser":this.canvas.style.cursor='url(\'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 20 20"><circle cx="10" cy="10" r="8" fill="none" stroke="white" stroke-width="2"/><circle cx="10" cy="10" r="6" fill="none" stroke="black" stroke-width="1"/></svg>\') 10 10, auto';break;case"mouse":default:this.canvas.style.cursor="default";break;case"hand":this.canvas.style.cursor="grab";break;case"text":this.canvas.style.cursor="text"}}}sendText(){this.socket.send(JSON.stringify({type:"text",text:this.text.text,x:this.text.x,y:this.text.y,fontSize:this.fontSize,fontFamily:this.currentFont,roomId:this.roomId,sentBy:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImI0Y2Q4ZWM3LTM1NWUtNGZlYy04YzNiLWIwYzUyYmU1MTFlMCIsImlhdCI6MTc1MzgwNjQ1NH0.bER-qZ5Lvk39mxILYj8O09aIjFeA5x8A1mST4dLyu7I"})),this.renderCanvas(),this.setSelectedTool("mouse")}clearCanvas(){this.existingShapes=[],this.renderCanvas(),this.clickedShape=void 0,this.clickedShapeIndex=-1,this.prevShape=void 0,this.socket.send(JSON.stringify({type:"clear_canvas",roomId:this.roomId,sentBy:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImI0Y2Q4ZWM3LTM1NWUtNGZlYy04YzNiLWIwYzUyYmU1MTFlMCIsImlhdCI6MTc1MzgwNjQ1NH0.bER-qZ5Lvk39mxILYj8O09aIjFeA5x8A1mST4dLyu7I"}))}clearSelection(){this.clickedShape=void 0,this.clickedShapeIndex=-1,this.renderCanvas()}isPointInsideShape(e,t,s){if("rect"===s.type){let i=s.width<0?s.x+s.width:s.x,a=s.height<0?s.y+s.height:s.y,o=Math.abs(s.width),r=Math.abs(s.height);return e>=i&&e<=i+o&&t>=a&&t<=a+r}if("circle"===s.type){var i,a,o,r;let n=null!==(a=null!==(i=s.radiusX)&&void 0!==i?i:s.radius)&&void 0!==a?a:0,l=null!==(r=null!==(o=s.radiusY)&&void 0!==o?o:s.radius)&&void 0!==r?r:0;if(0===n&&0===l)return!1;let d=(e-s.centerX)/n,h=(t-s.centerY)/l;return d*d+h*h<=1}if("diamond"===s.type)return function(e,t,s){let i=0,a=s.length;for(let o=0;o<a;o++){let r=s[o],n=s[(o+1)%a];r.y>t!=n.y>t&&e<(n.x-r.x)*(t-r.y)/(n.y-r.y)+r.x&&i++}return i%2==1}(e,t,[{x:s.x1,y:s.y1},{x:s.x2,y:s.y2},{x:s.x3,y:s.y3},{x:s.x4,y:s.y4}]);if("line"===s.type||"arrow"===s.type)return I(e,t,s.x1,s.y1,s.x2,s.y2);if("pencil"===s.type)return function(e,t,s){let i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5;for(let a=0;a<s.length-1;a++)if(I(e,t,s[a].x,s[a].y,s[a+1].x,s[a+1].y,i))return!0;return!1}(e,t,s.points);if("text"===s.type){this.ctx.font="".concat(s.fontSize,"px ").concat(s.fontFamily,", sans-serif");let i=this.ctx.measureText(s.text).width,a=s.fontSize;return e>=s.x&&e<=s.x+i&&t>=s.y&&t<=s.y+a}return!1}async init(){this.existingShapes=await C(this.roomId),console.log("shapes",this.existingShapes),this.renderCanvas()}deleteShape(){if(void 0===this.clickedShapeIndex){console.error("Error: clickedShapeIndex is undefined.");return}this.existingShapes=this.existingShapes.filter(e=>{let{id:t}=e;return t!==this.clickedShapeIndex}),this.socket.send(JSON.stringify({type:"delete_shape",shape:this.clickedShapeIndex,roomId:this.roomId,sentBy:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImI0Y2Q4ZWM3LTM1NWUtNGZlYy04YzNiLWIwYzUyYmU1MTFlMCIsImlhdCI6MTc1MzgwNjQ1NH0.bER-qZ5Lvk39mxILYj8O09aIjFeA5x8A1mST4dLyu7I"}))}initHandlers(){this.socket.onmessage=e=>{var t,s,i;let a=JSON.parse(e.data);if("chat"==a.type){console.log(a);let e=JSON.parse(a.id),s=JSON.parse(a.message);console.log("parsedSHape",s);let i={shape:s.shape,id:e};this.existingShapes.push(i),a.sentBy===(null===(t=this.session)||void 0===t?void 0:t.accessToken)&&(this.clickedShape=i,this.clickedShapeIndex=e,this.prevShape=JSON.parse(JSON.stringify(i))),this.renderCanvas()}else if("delete_shape"==a.type){console.log("delete shape ",a);let e=JSON.parse(a.id);this.clickedShapeIndex=e,this.deleteShape()}else if("update_shape"===a.type){a.sentBy,console.log("update shape msg rcvd ",a);let e=this.existingShapes.findIndex(e=>e.id===a.shape.id);-1!==e?this.existingShapes[e].shape=a.shape.shape:this.existingShapes.push({id:a.shape.id,shape:a.shape.shape}),this.renderCanvas()}else if("update_shape_color"===a.type){console.log("update_shape_color received 69",a);let e=this.existingShapes.findIndex(e=>e.id===a.id);-1!==e&&(this.existingShapes[e].color=a.color,this.renderCanvas())}else if("update_shape_stroke_width"===a.type){console.log("update_shape_stroke_width received 69",a);let e=this.existingShapes.findIndex(e=>e.id===a.id);-1!==e&&(this.existingShapes[e].shape,this.existingShapes[e].strokeWidth=null===(s=a.shape)||void 0===s?void 0:s.strokeWidth,this.renderCanvas())}else if("text"===a.type){console.log("text message received",a);let e=a.id,t={shape:{type:"text",x:a.x,y:a.y,text:a.text,fontSize:a.fontSize,fontFamily:a.fontFamily},id:e};this.existingShapes.push(t),a.sentBy===(null===(i=this.session)||void 0===i?void 0:i.accessToken)&&(this.clickedShape=t,this.clickedShapeIndex=e,this.prevShape=JSON.parse(JSON.stringify(t))),this.renderCanvas()}else if("update_shape_text"===a.type){console.log("update_shape_text received",a);let e=a.id,t=this.existingShapes.findIndex(t=>t.id===e);if(-1!==t){let e={type:"text",x:a.shape.shape.x,y:a.shape.shape.y,text:a.shape.shape.text,fontSize:a.shape.shape.fontSize,fontFamily:a.shape.shape.fontFamily};this.existingShapes[t].shape=e}this.renderCanvas()}else"clear_canvas"===a.type&&(this.existingShapes=[],this.clickedShape=void 0,this.clickedShapeIndex=-1,this.prevShape=void 0,this.renderCanvas())}}renderCanvas(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.ctx.fillStyle=this.isDarkTheme?"rgba(18,18,18,255)":"rgba(255, 255, 255, 1)",this.ctx.fillRect(0,0,this.canvas.width,this.canvas.height),this.onCanvasUpdate&&this.onCanvasUpdate(),this.ctx.save(),this.ctx.translate(this.panOffset.x,this.panOffset.y),this.ctx.scale(this.zoom/100,this.zoom/100),this.existingShapes.forEach(e=>{let{shape:t,id:s,color:i,strokeWidth:a}=e;if(this.ctx.strokeStyle=i||(this.isDarkTheme?"#ffffff":"#000000"),this.ctx.lineWidth=a||2,this.ctx.fillStyle=i||(this.isDarkTheme?"#ffffff":"#000000"),(null==t?void 0:t.type)==="rect")this.drawRoundedRect(t.x,t.y,t.width,t.height);else if("circle"===t.type){var o,r,n,l;let e=Math.abs(null!==(r=null!==(o=t.radiusX)&&void 0!==o?o:t.radius)&&void 0!==r?r:0),s=Math.abs(null!==(l=null!==(n=t.radiusY)&&void 0!==n?n:t.radius)&&void 0!==l?l:0);e>0&&s>0&&(this.ctx.beginPath(),this.ctx.ellipse(t.centerX,t.centerY,e,s,0,0,2*Math.PI),this.ctx.stroke(),this.ctx.closePath())}else if((null==t?void 0:t.type)==="diamond")this.ctx.beginPath(),this.ctx.moveTo(t.x1,t.y1),this.ctx.lineTo(t.x2,t.y2),this.ctx.lineTo(t.x3,t.y3),this.ctx.lineTo(t.x4,t.y4),this.ctx.closePath(),this.ctx.stroke();else if((null==t?void 0:t.type)==="line")this.ctx.beginPath(),this.ctx.moveTo(t.x1,t.y1),this.ctx.lineTo(t.x2,t.y2),this.ctx.stroke();else if((null==t?void 0:t.type)==="arrow"){let e=Math.atan2(t.y2-t.y1,t.x2-t.x1);this.ctx.beginPath(),this.ctx.moveTo(t.x1,t.y1),this.ctx.lineTo(t.x2,t.y2);let s=t.x2-14*Math.cos(e-Math.PI/6),i=t.y2-14*Math.sin(e-Math.PI/6),a=t.x2-14*Math.cos(e+Math.PI/6),o=t.y2-14*Math.sin(e+Math.PI/6);this.ctx.moveTo(t.x2,t.y2),this.ctx.lineTo(s,i),this.ctx.moveTo(t.x2,t.y2),this.ctx.lineTo(a,o),this.ctx.stroke()}else if((null==t?void 0:t.type)==="pencil"){console.log("rendering pencil",t);for(let e=0;e<t.points.length-1;e++)this.ctx.beginPath(),this.ctx.moveTo(t.points[e].x,t.points[e].y),this.ctx.lineTo(t.points[e+1].x,t.points[e+1].y),this.ctx.lineWidth=a||2,this.ctx.stroke()}else(null==t?void 0:t.type)==="text"&&(this.ctx.font="".concat(t.fontSize,"px ").concat(t.fontFamily,", sans-serif"),this.ctx.textBaseline="top",this.ctx.fillText(t.text,t.x,t.y));this.clickedShape&&this.clickedShape.shape}),this.drawSelectionBox(),this.ctx.restore()}initMouseHandlers(){this.canvas.addEventListener("mousedown",this.mouseDownHandler),this.canvas.addEventListener("mouseup",this.mouseUpHandler),this.canvas.addEventListener("mousemove",this.mouseMoveHandler)}constructor(e,t,s,i,a,o="dark",r){this.startX=0,this.startY=0,this.currentMouseX=0,this.currentMouseY=0,this.pencilPath=[],this.selectedTool="circle",this.diamondCoords={P1:{x:0,y:0},P2:{x:0,y:0},P3:{x:0,y:0},P4:{x:0,y:0}},this.lineCoords={P1:{x:0,y:0},P2:{x:0,y:0}},this.arrowCoords={P1:{x:0,y:0},P2:{x:0,y:0}},this.clickedShapeIndex=-1,this.isDarkTheme=!0,this.text={text:"",x:0,y:0,fontSize:24,fontFamily:"Virgil"},this.currentFont="Virgil",this.fontSize=24,this.isDragging=!1,this.dragOffset={x:0,y:0},this.isResizing=!1,this.resizeHandle="",this.resizeStartData={width:0,height:0,x:0,y:0},this.zoom=100,this.panOffset={x:0,y:0},this.mouseDownHandler=e=>{this.clicked=!0;let t=this.screenToCanvas(e.clientX,e.clientY);if(this.startX=t.x,this.startY=t.y,this.isDragging=!1,console.log(this.selectedTool,"tool"),"mouse"!==this.selectedTool&&this.clearSelection(),"mouse"===this.selectedTool){if(this.clickedShape){let e=this.getResizeHandle(t.x,t.y);if(e){this.isResizing=!0,this.resizeHandle=e;let t=this.clickedShape.shape;if("rect"===t.type)this.resizeStartData={width:t.width,height:t.height,x:t.x,y:t.y};else if("circle"===t.type){var s,i,a,o;let e=Math.abs(null!==(i=null!==(s=t.radiusX)&&void 0!==s?s:t.radius)&&void 0!==i?i:0),r=Math.abs(null!==(o=null!==(a=t.radiusY)&&void 0!==a?a:t.radius)&&void 0!==o?o:0);this.resizeStartData={width:2*e,height:2*r,x:t.centerX-e,y:t.centerY-r}}else if("diamond"===t.type){let e=Math.min(t.x1,t.x2,t.x3,t.x4),s=Math.min(t.y1,t.y2,t.y3,t.y4),i=Math.max(t.x1,t.x2,t.x3,t.x4),a=Math.max(t.y1,t.y2,t.y3,t.y4);this.resizeStartData={width:i-e,height:a-s,x:e,y:s}}else"line"===t.type||"arrow"===t.type?this.resizeStartData={width:t.x2-t.x1,height:t.y2-t.y1,x:t.x1,y:t.y1}:"text"===t.type&&(this.resizeStartData={width:t.fontSize,height:t.fontSize,x:t.x,y:t.y});return}}let e=this.existingShapes.find(e=>{let{shape:s}=e;return this.isPointInsideShape(t.x,t.y,s)});if(e){switch(this.clickedShape=e,console.log("clicked shape 818818",this.clickedShape),this.clickedShapeIndex=e.id,this.prevShape=JSON.parse(JSON.stringify(e)),this.isDragging=!0,e.shape.type){case"rect":case"text":this.dragOffset={x:t.x-e.shape.x,y:t.y-e.shape.y};break;case"diamond":let s=(e.shape.x1+e.shape.x2+e.shape.x3+e.shape.x4)/4,i=(e.shape.y1+e.shape.y2+e.shape.y3+e.shape.y4)/4;this.dragOffset={x:t.x-s,y:t.y-i};break;case"circle":this.dragOffset={x:t.x-e.shape.centerX,y:t.y-e.shape.centerY};break;case"line":case"arrow":this.dragOffset={x:t.x-e.shape.x1,y:t.y-e.shape.y1};break;case"pencil":if("pencil"===e.shape.type){let s=e.shape;s.points.length>0&&(this.dragOffset={x:t.x-s.points[0].x,y:t.y-s.points[0].y})}}console.log("text",this.text),this.renderCanvas(),this.updateCursor()}else this.clickedShape=void 0,this.clickedShapeIndex=-1,this.renderCanvas()}},this.mouseUpHandler=e=>{var t,s;this.clicked=!1;let i=this.screenToCanvas(e.clientX,e.clientY),a=i.x-this.startX,o=i.y-this.startY;if(this.isDragging=!1,this.isResizing&&this.clickedShape){this.isResizing=!1,this.resizeHandle="",this.socket.send(JSON.stringify({type:"update_shape",message:JSON.stringify({shape:this.clickedShape}),roomId:this.roomId,sentBy:(null===(t=this.session)||void 0===t?void 0:t.accessToken)||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImI0Y2Q4ZWM3LTM1NWUtNGZlYy04YzNiLWIwYzUyYmU1MTFlMCIsImlhdCI6MTc1MzgwNjQ1NH0.bER-qZ5Lvk39mxILYj8O09aIjFeA5x8A1mST4dLyu7I"}));return}let r=this.selectedTool,n=null;console.log("clicled",JSON.stringify(this.clickedShape),"clicked",JSON.stringify(this.prevShape));let l=JSON.stringify(this.clickedShape)===JSON.stringify(this.prevShape);if("mouse"!==this.selectedTool||!this.clickedShape||this.isDragging||l||(console.log("shape changed ",this.clickedShape),this.socket.send(JSON.stringify({type:"update_shape",message:JSON.stringify({shape:this.clickedShape}),roomId:this.roomId,sentBy:(null===(s=this.session)||void 0===s?void 0:s.accessToken)||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImI0Y2Q4ZWM3LTM1NWUtNGZlYy04YzNiLWIwYzUyYmU1MTFlMCIsImlhdCI6MTc1MzgwNjQ1NH0.bER-qZ5Lvk39mxILYj8O09aIjFeA5x8A1mST4dLyu7I"}))),this.updateCursor(),"rect"===r)n={type:"rect",x:this.startX,y:this.startY,height:o,width:a};else if("circle"===r){let e=this.startX+a,t=this.startY+o,s=(this.startX+e)/2;n={type:"circle",centerX:s,centerY:(this.startY+t)/2,radiusX:Math.abs(e-this.startX)/2,radiusY:Math.abs(t-this.startY)/2}}else if("pencil"===r)console.log("pencil inserting",n={type:"pencil",points:this.pencilPath}),this.pencilPath=[];else if("diamond"===r)n={type:"diamond",x1:this.diamondCoords.P1.x,y1:this.diamondCoords.P1.y,x2:this.diamondCoords.P2.x,y2:this.diamondCoords.P2.y,x3:this.diamondCoords.P3.x,y3:this.diamondCoords.P3.y,x4:this.diamondCoords.P4.x,y4:this.diamondCoords.P4.y},this.diamondCoords={P1:{x:0,y:0},P2:{x:0,y:0},P3:{x:0,y:0},P4:{x:0,y:0}};else if("line"===r)n={type:"line",x1:this.lineCoords.P1.x,y1:this.lineCoords.P1.y,x2:this.lineCoords.P2.x,y2:this.lineCoords.P2.y},this.lineCoords={P1:{x:0,y:0},P2:{x:0,y:0}};else if("arrow"===r)n={type:"arrow",x1:this.arrowCoords.P1.x,y1:this.arrowCoords.P1.y,x2:this.arrowCoords.P2.x,y2:this.arrowCoords.P2.y};else if("text"===r){this.text.x=i.x,this.text.y=i.y;return}n&&(console.log(n),this.socket.send(JSON.stringify({type:"chat",message:JSON.stringify({shape:n}),roomId:this.roomId})),this.setSelectedTool("mouse"))},this.mouseMoveHandler=e=>{if(this.clicked){let t=this.screenToCanvas(e.clientX,e.clientY);this.currentMouseX=t.x,this.currentMouseY=t.y;let s=t.x-this.startX,i=t.y-this.startY;if(this.renderCanvas(),this.drawPreview(),"pencil"===this.selectedTool){let e=t.x,s=t.y;this.pencilPath.push({x:e,y:s})}if("diamond"===this.selectedTool){let e=this.startX+s/2,t=this.startY+i/2;this.diamondCoords.P1={x:e,y:this.startY},this.diamondCoords.P2={x:this.startX+s,y:t},this.diamondCoords.P3={x:e,y:this.startY+i},this.diamondCoords.P4={x:this.startX,y:t}}if("line"===this.selectedTool&&(this.lineCoords.P1={x:this.startX,y:this.startY},this.lineCoords.P2={x:t.x,y:t.y}),"arrow"===this.selectedTool)this.arrowCoords.P1={x:this.startX,y:this.startY},this.arrowCoords.P2={x:t.x,y:t.y};else if("eraser"===this.selectedTool){let e=this.existingShapes.find(e=>{let{shape:s}=e;return this.isPointInsideShape(t.x,t.y,s)});e?(console.log(e.id,"del"),this.clickedShapeIndex=e.id,console.log(this.clickedShapeIndex,"pleasw"),this.deleteShape()):console.log("no shape to del")}else if("text"===this.selectedTool)return}if(this.isResizing&&this.clickedShape&&this.clicked&&"mouse"===this.selectedTool){let t=this.screenToCanvas(e.clientX,e.clientY),s=t.x-this.startX,i=t.y-this.startY,a=this.clickedShape.shape;if("rect"===a.type){let t=this.resizeStartData.width,o=this.resizeStartData.height,r=this.resizeStartData.x,n=this.resizeStartData.y,l=e.shiftKey,d=t/o,h=t,c=o,x=r,u=n;switch(this.resizeHandle){case"se":h=t+s,c=o+i,l&&(c=h/d);break;case"sw":x=r+s,h=t-s,c=o+i,l&&(c=h/d);break;case"ne":u=n+i,h=t+s,c=o-i,l&&(c=h/d);break;case"nw":x=r+s,u=n+i,h=t-s,c=o-i,l&&(c=h/d)}Math.abs(h)>=10&&Math.abs(c)>=10&&(a.x=x,a.y=u,a.width=h,a.height=c)}else if("circle"===a.type){let t=this.resizeStartData.width/2,o=this.resizeStartData.height/2,r=this.resizeStartData.x+t,n=this.resizeStartData.y+o,l=e.shiftKey,d=t,h=o,c=r,x=n;switch(this.resizeHandle){case"se":if(d=t+s/2,h=o+i/2,c=r+s/2,x=n+i/2,l){let e=Math.max(d,h);d=e,h=e}break;case"sw":if(c=r+s/2,d=t-s/2,h=o+i/2,l){let e=Math.max(Math.abs(d),Math.abs(h));d=e,h=e}break;case"ne":if(d=t+s/2,h=o-i/2,c=r+s/2,x=n+i/2,l){let e=Math.max(Math.abs(d),Math.abs(h));d=e,h=e}break;case"nw":if(c=r+s/2,x=n+i/2,d=t-s/2,h=o-i/2,l){let e=Math.max(Math.abs(d),Math.abs(h));d=e,h=e}}Math.abs(d)>=5&&Math.abs(h)>=5&&(a.centerX=c,a.centerY=x,a.radiusX=Math.abs(d),a.radiusY=Math.abs(h))}else if("diamond"===a.type){let t=this.resizeStartData.width,o=this.resizeStartData.height,r=this.resizeStartData.x+t/2,n=this.resizeStartData.y+o/2,l=e.shiftKey,d=t/o,h=t,c=o,x=r,u=n;switch(this.resizeHandle){case"se":x=r+s/2,u=n+i/2,h=t+s,c=o+i,l&&(c=h/d);break;case"sw":x=r+s/2,u=n+i/2,h=t-s,c=o+i,l&&(c=h/d);break;case"ne":x=r+s/2,u=n+i/2,h=t+s,c=o-i,l&&(c=h/d);break;case"nw":x=r+s/2,u=n+i/2,h=t-s,c=o-i,l&&(c=h/d)}if(Math.abs(h)>=10&&Math.abs(c)>=10){let e=h/2,t=c/2;a.x1=x,a.y1=u-t,a.x2=x+e,a.y2=u,a.x3=x,a.y3=u+t,a.x4=x-e,a.y4=u}}else if("line"===a.type||"arrow"===a.type){let e=this.resizeStartData.x,t=this.resizeStartData.y,o=e+this.resizeStartData.width,r=t+this.resizeStartData.height;switch(this.resizeHandle){case"se":a.x2=o+s,a.y2=r+i;break;case"nw":a.x1=e+s,a.y1=t+i;break;case"ne":a.x2=o+s,a.y1=t+i;break;case"sw":a.x1=e+s,a.y2=r+i}}else if("text"===a.type){let e=this.resizeStartData.width;this.resizeStartData.x,this.resizeStartData.y;let t=Math.max(Math.abs(s),Math.abs(i)),o=s>0||i>0?1:-1;switch(this.resizeHandle){case"se":let r=Math.max(8,e+t*o);a.fontSize=r;break;case"sw":let n=Math.max(8,e+t*o);a.fontSize=n;break;case"ne":let l=Math.max(8,e+t*o);a.fontSize=l;break;case"nw":let d=Math.max(8,e+t*o);a.fontSize=d}}this.renderCanvas();return}if(this.isDragging&&this.clickedShape&&this.clicked&&"mouse"===this.selectedTool){let t=this.screenToCanvas(e.clientX,e.clientY);switch(this.clickedShape.shape.type){case"rect":case"text":this.clickedShape.shape.x=t.x-this.dragOffset.x,this.clickedShape.shape.y=t.y-this.dragOffset.y;break;case"diamond":let s=t.x-this.dragOffset.x,i=t.y-this.dragOffset.y,a=(this.clickedShape.shape.x1+this.clickedShape.shape.x2+this.clickedShape.shape.x3+this.clickedShape.shape.x4)/4,o=(this.clickedShape.shape.y1+this.clickedShape.shape.y2+this.clickedShape.shape.y3+this.clickedShape.shape.y4)/4,r=s-a,n=i-o;this.clickedShape.shape.x1+=r,this.clickedShape.shape.y1+=n,this.clickedShape.shape.x2+=r,this.clickedShape.shape.y2+=n,this.clickedShape.shape.x3+=r,this.clickedShape.shape.y3+=n,this.clickedShape.shape.x4+=r,this.clickedShape.shape.y4+=n;break;case"circle":this.clickedShape.shape.centerX=t.x-this.dragOffset.x,this.clickedShape.shape.centerY=t.y-this.dragOffset.y;break;case"line":case"arrow":let l=t.x-this.dragOffset.x,d=t.y-this.dragOffset.y,h=l-this.clickedShape.shape.x1,c=d-this.clickedShape.shape.y1;this.clickedShape.shape.x1+=h,this.clickedShape.shape.y1+=c,this.clickedShape.shape.x2+=h,this.clickedShape.shape.y2+=c;break;case"pencil":if("pencil"===this.clickedShape.shape.type){let e=this.clickedShape.shape;if(e.points.length>0){let s=t.x-this.dragOffset.x,i=t.y-this.dragOffset.y;e.points=e.points.map(t=>({x:t.x+s-e.points[0].x,y:t.y+i-e.points[0].y}))}}}this.updateCursor()}},this.resizeCanvas=()=>{this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,console.log("Canvas data",this.canvas.width,this.canvas.height)},this.canvas=e,this.ctx=e.getContext("2d"),this.existingShapes=[],this.roomId=t,this.socket=s,this.clicked=!1,this.init(),this.initHandlers(),this.initMouseHandlers(),this.setSelectedTool=i,this.session=a,this.onCanvasUpdate=r,this.isDarkTheme="dark"===o||"system"===o&&window.matchMedia("(prefers-color-scheme: dark)").matches,this.renderCanvas(),this.updateCursor()}}var M=s(95646),z=s(96742);let T=e=>{let{zoom:t,onZoomChange:s}=e;return(0,i.jsx)("div",{className:"fixed bottom-0 left-0 p-5",children:(0,i.jsxs)("div",{className:"flex items-center bg-[#191919] cursor-pointer rounded-lg",children:[(0,i.jsx)("div",{className:"text-white px-4 py-2 hover:bg-gray-800 rounded-l-lg",onClick:()=>{s(Math.max(t-10,10))},children:(0,i.jsx)(M.A,{className:"text-white size-4"})}),(0,i.jsxs)("div",{className:"px-4 text-white py-2 bg-[#191919] text-sm",children:[t,"%"]}),(0,i.jsx)("div",{className:"text-white px-4 py-2 hover:bg-gray-800 rounded-r-lg",onClick:()=>{s(Math.min(t+10,300))},children:(0,i.jsx)(z.A,{className:"text-white size-4"})})]})})},Y=e=>{let{canvasRef:t,zoom:s,setZoom:i,panOffset:o,setPanOffset:r,scale:n,game:l}=e,[d,h]=(0,a.useState)(!1),[c,x]=(0,a.useState)({x:0,y:0});(0,a.useEffect)(()=>{let e=t.current;if(!e)return;let a=t=>{t.preventDefault();let a=Math.min(Math.max(s+(t.deltaY<0?10:-10),30),200),l=e.getBoundingClientRect(),d=(t.clientX-l.left-o.x)/n,h=(t.clientY-l.top-o.y)/n;r({x:t.clientX-a/100*d,y:t.clientY-a/100*h}),i(a)},u=e=>{(null==l?void 0:l.selectedTool)==="hand"&&(h(!0),x({x:e.clientX-o.x,y:e.clientY-o.y}))},p=e=>{d&&(null==l?void 0:l.selectedTool)==="hand"&&r({x:e.clientX-c.x,y:e.clientY-c.y})},m=()=>h(!1);return e.addEventListener("wheel",a,{passive:!1}),e.addEventListener("mousedown",u),e.addEventListener("mousemove",p),e.addEventListener("mouseup",m),()=>{e.removeEventListener("wheel",a),e.removeEventListener("mousedown",u),e.removeEventListener("mousemove",p),e.removeEventListener("mouseup",m)}},[n,o,s,i,r,t,l,d,c])};var P=s(84687),X=s(70211),L=s(71955),O=s(67748),F=s(4187);let J=e=>{var t,s,o,r,n,d,h,c,x,u,p,m,g,v,y,f,k,b,w,S,j,C,I,N,M,z,T,Y,J,D,U,W,E;let[H,A]=(0,a.useState)(!1),[_,R]=(0,a.useState)("#ffffff");(0,a.useEffect)(()=>{var t,s;console.log("ShapeConfigModal useEffect triggered",null===(t=e.game)||void 0===t?void 0:t.clickedShapeIndex,null===(s=e.game)||void 0===s?void 0:s.clickedShape)},[null===(t=e.game)||void 0===t?void 0:t.clickedShapeIndex,null===(s=e.game)||void 0===s?void 0:s.clickedShape,e.canvasUpdateTrigger]),console.log("ShapeConfigModal render",e.showShapeConfigModal,null===(o=e.game)||void 0===o?void 0:o.clickedShape,99);let Z=e=>{R(e)};return(0,a.useEffect)(()=>()=>{A(!1)},[e.showShapeConfigModal]),(0,i.jsx)(L.N,{mode:"popLayout",children:e.showShapeConfigModal&&(null===(r=e.game)||void 0===r?void 0:r.selectedTool)!=="eraser"&&(0,i.jsx)(O.P.div,{initial:{x:-100},animate:{x:0},exit:{x:-300},transition:{duration:.2,ease:[.19,1,.22,1]},className:"absolute left-4 font-satoshi  top-36 -translate-y-1/2 w-64 h-auto bg-[#191919] border border-gray-300/10 rounded-lg shadow-lg z-[10] p-4",children:(0,i.jsxs)("div",{className:"flex flex-col gap-3 justify-between mb-3",children:[(0,i.jsx)("p",{className:"text-white text-sm capitalize font-bold",children:null===(n=e.shape)||void 0===n?void 0:n.shape.type}),(0,i.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,i.jsx)("p",{className:"text-white text-sm text-white",children:"Stroke"}),(0,i.jsxs)("div",{className:"flex gap-2 items-center",children:[["#ef4444","#eab308","#3b82f6","#a855f7","#f97316","#ec4899"].map((t,s)=>{var a,o;return(0,i.jsx)("div",{className:"w-6 h-6 rounded-md cursor-pointer transition-all duration-200 hover:scale-110 ".concat((null===(o=e.game)||void 0===o?void 0:null===(a=o.clickedShape)||void 0===a?void 0:a.color)===t?"ring-2 ring-blue-500 ring-offset-2 ring-offset-[#191919] scale-110":""),style:{backgroundColor:t},onClick:()=>{var s,i;null===(i=e.game)||void 0===i||i.updateShapeColor(null===(s=e.game)||void 0===s?void 0:s.clickedShapeIndex,t),Z(t)}},s)}),(0,i.jsx)("div",{className:"w-[1px] h-6 bg-gray-500 rounded-md"}),(0,i.jsx)("div",{className:"w-6 h-6 rounded-md cursor-pointer hover:scale-110 transition-transform border border-gray-600",style:{backgroundColor:_},onClick:()=>A(!H)}),H&&(0,i.jsx)("div",{className:"absolute top-28 left-[142px] z-50",children:(0,i.jsx)(F.kH,{color:_,onChangeComplete:t=>{var s,i;null===(i=e.game)||void 0===i||i.updateShapeColor(null===(s=e.game)||void 0===s?void 0:s.clickedShapeIndex,t.hex),R(t.hex),A(!1)}})})]})]}),(0,i.jsx)("div",{className:"flex flex-col gap-1",children:(null===(d=e.shape)||void 0===d?void 0:d.shape.type)!=="text"?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("p",{className:"text-white text-sm text-white",children:"Stroke Width"}),(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("div",{onClick:()=>{var t,s;return null===(s=e.game)||void 0===s?void 0:s.updateShapeStrokeWidth(null===(t=e.game)||void 0===t?void 0:t.clickedShapeIndex,2)},className:"w-10 h-10 rounded-md bg-white flex items-center px-2 transition-all duration-200 ".concat((null===(c=e.game)||void 0===c?void 0:null===(h=c.clickedShape)||void 0===h?void 0:h.strokeWidth)===2?"border-2 border-blue-500 shadow-lg scale-105":"border border-gray-300 hover:border-gray-400"),children:(0,i.jsx)("div",{className:"w-full h-[1px] bg-black/50 rounded-full"})}),(0,i.jsx)("div",{onClick:()=>{var t,s;return null===(s=e.game)||void 0===s?void 0:s.updateShapeStrokeWidth(null===(t=e.game)||void 0===t?void 0:t.clickedShapeIndex,4)},className:"w-10 h-10 rounded-md bg-white flex items-center px-2 transition-all duration-200 ".concat((null===(u=e.game)||void 0===u?void 0:null===(x=u.clickedShape)||void 0===x?void 0:x.strokeWidth)===4?"border-2 border-blue-500 shadow-lg scale-105":"border border-gray-300 hover:border-gray-400"),children:(0,i.jsx)("div",{className:"w-full h-[3px] bg-black/50 rounded-full"})}),(0,i.jsx)("div",{onClick:()=>{var t,s;return null===(s=e.game)||void 0===s?void 0:s.updateShapeStrokeWidth(null===(t=e.game)||void 0===t?void 0:t.clickedShapeIndex,6)},className:"w-10 h-10 rounded-md bg-white flex items-center px-2 transition-all duration-200 ".concat((null===(m=e.game)||void 0===m?void 0:null===(p=m.clickedShape)||void 0===p?void 0:p.strokeWidth)===6?"border-2 border-blue-500 shadow-lg scale-105":"border border-gray-300 hover:border-gray-400"),children:(0,i.jsx)("div",{className:"w-full h-[5px] bg-black/50 rounded-full"})})]})]}):(0,i.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,i.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,i.jsx)("p",{className:"text-white text-sm",children:"Font Size"}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("button",{onClick:()=>{var t,s,i,a,o,r;null===(t=e.game)||void 0===t||t.setFontSize(24),null===(r=e.game)||void 0===r||r.updateText(null===(s=e.game)||void 0===s?void 0:s.clickedShapeIndex,24,(null===(o=e.game)||void 0===o?void 0:null===(a=o.clickedShape)||void 0===a?void 0:null===(i=a.shape)||void 0===i?void 0:i.fontFamily)||"Satoshi")},title:"Small",className:"size-8 rounded-md bg-white flex items-center justify-center transition-all duration-200 ".concat((null===(y=e.game)||void 0===y?void 0:null===(v=y.clickedShape)||void 0===v?void 0:null===(g=v.shape)||void 0===g?void 0:g.fontSize)===24?"border-2 border-blue-500 shadow-lg scale-105":"border border-gray-300 hover:border-gray-400"),children:(0,i.jsxs)("svg",{"aria-hidden":"true",focusable:"false",role:"img",viewBox:"0 0 20 20",className:"",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",children:[(0,i.jsx)("g",{"clip-path":"url(#a)",children:(0,i.jsx)("path",{d:"M14.167 6.667a3.333 3.333 0 0 0-3.334-3.334H9.167a3.333 3.333 0 0 0 0 6.667h1.666a3.333 3.333 0 0 1 0 6.667H9.167a3.333 3.333 0 0 1-3.334-3.334",stroke:"currentColor","stroke-width":"1.25","stroke-linecap":"round","stroke-linejoin":"round"})}),(0,i.jsx)("defs",{children:(0,i.jsx)("clipPath",{id:"a",children:(0,i.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]})}),(0,i.jsx)("button",{onClick:()=>{var t,s,i,a,o,r;null===(t=e.game)||void 0===t||t.setFontSize(28),null===(r=e.game)||void 0===r||r.updateText(null===(s=e.game)||void 0===s?void 0:s.clickedShapeIndex,28,(null===(o=e.game)||void 0===o?void 0:null===(a=o.clickedShape)||void 0===a?void 0:null===(i=a.shape)||void 0===i?void 0:i.fontFamily)||"Satoshi")},title:"Medium",className:"size-8 rounded-md bg-white flex items-center justify-center transition-all duration-200 ".concat((null===(b=e.game)||void 0===b?void 0:null===(k=b.clickedShape)||void 0===k?void 0:null===(f=k.shape)||void 0===f?void 0:f.fontSize)===28?"border-2 border-blue-500 shadow-lg scale-105":"border border-gray-300 hover:border-gray-400"),children:(0,i.jsxs)("svg",{"aria-hidden":"true",focusable:"false",role:"img",viewBox:"0 0 20 20",className:"",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",children:[(0,i.jsx)("g",{"clip-path":"url(#a)",children:(0,i.jsx)("path",{d:"M5 16.667V3.333L10 15l5-11.667v13.334",stroke:"currentColor","stroke-width":"1.25","stroke-linecap":"round","stroke-linejoin":"round"})}),(0,i.jsx)("defs",{children:(0,i.jsx)("clipPath",{id:"a",children:(0,i.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]})}),(0,i.jsx)("button",{onClick:()=>{var t,s,i,a,o,r;null===(t=e.game)||void 0===t||t.setFontSize(32),null===(r=e.game)||void 0===r||r.updateText(null===(s=e.game)||void 0===s?void 0:s.clickedShapeIndex,32,(null===(o=e.game)||void 0===o?void 0:null===(a=o.clickedShape)||void 0===a?void 0:null===(i=a.shape)||void 0===i?void 0:i.fontFamily)||"Satoshi")},title:"Large",className:"size-8 rounded-md bg-white flex items-center justify-center transition-all duration-200 ".concat((null===(j=e.game)||void 0===j?void 0:null===(S=j.clickedShape)||void 0===S?void 0:null===(w=S.shape)||void 0===w?void 0:w.fontSize)===32?"border-2 border-blue-500 shadow-lg scale-105":"border border-gray-300 hover:border-gray-400"),children:(0,i.jsxs)("svg",{"aria-hidden":"true",focusable:"false",role:"img",viewBox:"0 0 20 20",className:"",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",children:[(0,i.jsx)("g",{"clip-path":"url(#a)",children:(0,i.jsx)("path",{d:"M5.833 3.333v13.334h8.334",stroke:"currentColor","stroke-width":"1.25","stroke-linecap":"round","stroke-linejoin":"round"})}),(0,i.jsx)("defs",{children:(0,i.jsx)("clipPath",{id:"a",children:(0,i.jsx)("path",{fill:"#fff",d:"M0 0h20v20H0z"})})})]})}),(0,i.jsx)("button",{onClick:()=>{var t,s,i,a,o,r;null===(t=e.game)||void 0===t||t.setFontSize(36),null===(r=e.game)||void 0===r||r.updateText(null===(s=e.game)||void 0===s?void 0:s.clickedShapeIndex,36,(null===(o=e.game)||void 0===o?void 0:null===(a=o.clickedShape)||void 0===a?void 0:null===(i=a.shape)||void 0===i?void 0:i.fontFamily)||"Satoshi")},title:"Huge",className:"size-8 rounded-md bg-white flex items-center justify-center transition-all duration-200 ".concat((null===(N=e.game)||void 0===N?void 0:null===(I=N.clickedShape)||void 0===I?void 0:null===(C=I.shape)||void 0===C?void 0:C.fontSize)===36?"border-2 border-blue-500 shadow-lg scale-105":"border border-gray-300 hover:border-gray-400"),children:(0,i.jsx)("svg",{"aria-hidden":"true",focusable:"false",role:"img",viewBox:"0 0 20 20",className:"",fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round",children:(0,i.jsx)("path",{d:"m1.667 3.333 6.666 13.334M8.333 3.333 1.667 16.667M11.667 3.333v13.334h6.666",stroke:"currentColor","stroke-width":"1.25","stroke-linecap":"round","stroke-linejoin":"round"})})})]})]}),(0,i.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,i.jsx)("p",{className:"text-white text-sm",children:"Font Family"}),(0,i.jsxs)("div",{className:"flex gap-2",children:[(0,i.jsx)("button",{onClick:()=>{var t,s,i,a,o,r,n;null===(t=e.game)||void 0===t||t.setFont("handwriting"),null===(n=e.game)||void 0===n||n.updateText(null===(s=e.game)||void 0===s?void 0:s.clickedShapeIndex,(null===(o=e.game)||void 0===o?void 0:null===(a=o.clickedShape)||void 0===a?void 0:null===(i=a.shape)||void 0===i?void 0:i.fontSize)||24,null===(r=e.game)||void 0===r?void 0:r.currentFont)},title:"Handwriting",className:"p-1 rounded-md transition-all duration-200 ".concat((null===(T=e.game)||void 0===T?void 0:null===(z=T.clickedShape)||void 0===z?void 0:null===(M=z.shape)||void 0===M?void 0:M.fontFamily)==="handwriting"?"bg-blue-100 border-2 border-blue-500 shadow-lg scale-105":"bg-white/90 border border-gray-300 hover:border-gray-400"),children:(0,i.jsx)(l.A,{className:"size-6 dark:text-black"})}),(0,i.jsx)("button",{onClick:()=>{var t,s,i,a,o,r,n;null===(t=e.game)||void 0===t||t.setFont("code"),null===(n=e.game)||void 0===n||n.updateText(null===(s=e.game)||void 0===s?void 0:s.clickedShapeIndex,(null===(o=e.game)||void 0===o?void 0:null===(a=o.clickedShape)||void 0===a?void 0:null===(i=a.shape)||void 0===i?void 0:i.fontSize)||24,null===(r=e.game)||void 0===r?void 0:r.currentFont)},title:"Code",className:"p-1 rounded-md flex items-center justify-center transition-all duration-200 ".concat((null===(D=e.game)||void 0===D?void 0:null===(J=D.clickedShape)||void 0===J?void 0:null===(Y=J.shape)||void 0===Y?void 0:Y.fontFamily)==="code"?"bg-blue-100 border-2 border-blue-500 shadow-lg scale-105":"bg-white border border-gray-300 hover:border-gray-400"),children:(0,i.jsx)(P.A,{className:"size-6 dark:text-black"})}),(0,i.jsx)("button",{onClick:()=>{var t,s,i,a,o,r,n;null===(t=e.game)||void 0===t||t.setFont("normal"),null===(n=e.game)||void 0===n||n.updateText(null===(s=e.game)||void 0===s?void 0:s.clickedShapeIndex,(null===(o=e.game)||void 0===o?void 0:null===(a=o.clickedShape)||void 0===a?void 0:null===(i=a.shape)||void 0===i?void 0:i.fontSize)||24,null===(r=e.game)||void 0===r?void 0:r.currentFont)},title:"Normal",className:"p-1 rounded-md flex items-center justify-center transition-all duration-200  ".concat((null===(E=e.game)||void 0===E?void 0:null===(W=E.clickedShape)||void 0===W?void 0:null===(U=W.shape)||void 0===U?void 0:U.fontFamily)==="normal"?"bg-blue-100 border-2 border-blue-500 shadow-lg scale-105":"bg-white border border-gray-300 hover:border-gray-400"),children:(0,i.jsx)(X.A,{className:"size-6 dark:text-black"})})]})]})]})}),(0,i.jsx)("div",{})]})})})};var D=s(45421),U=s(32352),W=s(2131),E=s(53160),H=s(11250),A=s(66166),_=s(18415),R=s(46925),Z=s(72290),B=s(30264),Q=s(39048);function G(){for(var e=arguments.length,t=Array(e),s=0;s<e;s++)t[s]=arguments[s];return(0,Q.QP)((0,B.$)(t))}function V(e){let{...t}=e;return(0,i.jsx)(Z.bL,{"data-slot":"dropdown-menu",...t})}function q(e){let{...t}=e;return(0,i.jsx)(Z.l9,{"data-slot":"dropdown-menu-trigger",...t})}function K(e){let{className:t,sideOffset:s=4,...a}=e;return(0,i.jsx)(Z.ZL,{children:(0,i.jsx)(Z.UC,{"data-slot":"dropdown-menu-content",sideOffset:s,className:G("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",t),...a})})}var $=s(27115),ee=s(48180);let et=e=>{let{game:t,setShowClearCanvasModal:s,setShowLiveCollaborationModal:a}=e,o=(0,$.useRouter)(),{theme:r,toggleTheme:n,setSystemTheme:l}=(0,ee.D)();return(0,i.jsx)("div",{className:"fixed top-4 right-4 z-50",children:(0,i.jsxs)(V,{children:[(0,i.jsx)(q,{onClick:()=>t.setTool("mouse"),children:(0,i.jsx)("button",{className:"border border-white/15 rounded-md dark:bg-[#191919] bg-black p-2 hover:opacity-80 transition-all duration-300",children:(0,i.jsx)(D.A,{className:"w-6 h-6 text-white "})})}),(0,i.jsxs)(K,{collisionPadding:{right:12,top:15},className:"w-48 bg-[#191919] border border-white/15",children:[(0,i.jsxs)(Z._2,{className:"w-full justify-between flex items-center gap-2 w-full  rounded-sm px-3 py-1.5 text-md outline-none text-white  rounded-lg transition-all ease-in-out cursor-pointer",children:[(0,i.jsx)("span",{className:" font-normal text-md  tracking-tighter text-inherit ",children:"Theme"}),(0,i.jsxs)("div",{className:"flex rounded-xl gap-2 border border-white/15 px-3 py-1",children:[(0,i.jsx)("button",{title:"Light Mode",onClick:e=>{e.preventDefault(),e.stopPropagation(),t.setTheme("light"),n()},children:(0,i.jsx)(U.A,{className:"size-6 px-1 rounded-md hover:opacity-80 transition-all duration-300 ".concat("light"===r?"bg-white text-black ":"text-white")})}),(0,i.jsx)("button",{title:"Dark Mode",onClick:e=>{e.preventDefault(),e.stopPropagation(),t.setTheme("dark"),n()},children:(0,i.jsx)(W.A,{className:"size-6 px-1 rounded-md hover:opacity-80 transition-all duration-300 ".concat("dark"===r?"bg-white text-black ":"text-white")})}),(0,i.jsx)("button",{title:"System Mode",onClick:e=>{e.preventDefault(),e.stopPropagation(),t.setTheme("system"),l()},children:(0,i.jsx)(E.A,{className:"size-6 px-1 rounded-md hover:opacity-80 transition-all duration-300 ".concat("system"===r?"bg-white text-black ":"text-white")})})]})]}),(0,i.jsx)(Z.mB,{color:"f0f0f0",className:"bg-white/30 text-white/30"}),(0,i.jsxs)(Z._2,{className:"w-full flex items-center gap-2 w-full  rounded-sm px-3 py-1.5 text-md outline-none text-white  transition-colors  hover:bg-gray-800 rounded-lg transition-all ease-in-out cursor-pointer",children:[(0,i.jsx)(H.A,{className:"size-5 text-inherit"}),(0,i.jsx)("span",{className:" font-normal text-md  tracking-tighter text-inherit ",children:"Home"})]}),(0,i.jsxs)(Z._2,{onClick:()=>{a(!0)},className:"w-full flex items-center gap-2 w-full  rounded-sm px-3 py-1.5 text-md outline-none text-white  transition-colors  hover:bg-gray-800 rounded-lg transition-all ease-in-out cursor-pointer",children:[(0,i.jsx)(A.A,{className:"size-5 text-inherit"}),(0,i.jsx)("span",{className:" font-normal text-md  tracking-tighter text-inherit ",children:"Live Collaboration"})]}),(0,i.jsxs)(Z._2,{onClick:()=>{s(!0)},className:"w-full flex gap-2 w-full items-center  rounded-sm px-3 py-1.5 text-md outline-none text-white hover:text-red-600 transition-colors  hover:bg-gray-800 rounded-lg transition-all ease-in-out cursor-pointer",children:[(0,i.jsx)(_.A,{className:"size-5 text-inherit"}),(0,i.jsx)("span",{className:"font-primary font-normal text-md tracking-tighter text-inherit ",children:"Clear Canvas"})]}),(0,i.jsx)(Z.mB,{className:"bg-gray-600/30"}),(0,i.jsxs)(Z._2,{onClick:()=>{o.push("/")},className:"w-full flex gap-2 w-full items-center  rounded-sm px-3 py-1.5 text-md outline-none text-white hover:text-red-600 transition-colors  hover:bg-gray-800 rounded-lg transition-all ease-in-out cursor-pointer",children:[(0,i.jsx)(R.A,{className:"size-5 text-inherit"}),(0,i.jsx)("span",{className:"font-primary font-normal text-md tracking-tighter text-inherit ",children:"Logout"})]})]})]})})};var es=s(44470);let ei=(0,s(26378).F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function ea(e){let{...t}=e;return(0,i.jsx)(es.bL,{"data-slot":"alert-dialog",...t})}function eo(e){let{...t}=e;return(0,i.jsx)(es.ZL,{"data-slot":"alert-dialog-portal",...t})}function er(e){let{className:t,...s}=e;return(0,i.jsx)(es.hJ,{"data-slot":"alert-dialog-overlay",className:G("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",t),...s})}function en(e){let{className:t,...s}=e;return(0,i.jsxs)(eo,{children:[(0,i.jsx)(er,{}),(0,i.jsx)(es.UC,{"data-slot":"alert-dialog-content",className:G("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t),...s})]})}function el(e){let{className:t,...s}=e;return(0,i.jsx)("div",{"data-slot":"alert-dialog-header",className:G("flex flex-col gap-2 text-center sm:text-left",t),...s})}function ed(e){let{className:t,...s}=e;return(0,i.jsx)("div",{"data-slot":"alert-dialog-footer",className:G("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",t),...s})}function eh(e){let{className:t,...s}=e;return(0,i.jsx)(es.hE,{"data-slot":"alert-dialog-title",className:G("text-lg font-semibold",t),...s})}function ec(e){let{className:t,...s}=e;return(0,i.jsx)(es.VY,{"data-slot":"alert-dialog-description",className:G("text-muted-foreground text-sm",t),...s})}function ex(e){let{className:t,...s}=e;return(0,i.jsx)(es.rc,{className:G(ei(),t),...s})}function eu(e){let{className:t,...s}=e;return(0,i.jsx)(es.ZD,{className:G(ei({variant:"outline"}),t),...s})}let ep=e=>{let{setShowClearCanvasModal:t,showClearCanvasModal:s,game:o}=e,r=e=>{e&&(e.stopPropagation(),e.preventDefault()),t(!1)};return(0,a.useEffect)(()=>()=>{document.body.style.pointerEvents="auto",document.body.style.userSelect="auto"},[]),(0,i.jsx)(ea,{open:s,onOpenChange:e=>{},children:(0,i.jsxs)(en,{onClick:e=>e.stopPropagation(),onMouseDown:e=>e.stopPropagation(),onMouseUp:e=>e.stopPropagation(),className:"tracking-tight bg-gray-100 dark:bg-black border-gray-200 dark:bg-[#191919] dark:border-white/15 ",children:[(0,i.jsxs)(el,{children:[(0,i.jsx)(eh,{children:"Clear Canvas"}),(0,i.jsx)(ec,{children:"This will clear the canvas and delete all elements. Are you sure?"})]}),(0,i.jsxs)(ed,{children:[(0,i.jsx)(eu,{onClick:r,children:"Cancel"}),(0,i.jsx)(ex,{className:"bg-red-600 text-white hover:bg-red-700",onClick:()=>{null==o||o.clearCanvas(),r()},children:"Continue"})]})]})})};var em=s(32871);let eg=e=>{let{setShowLiveCollaborationModal:t,showLiveCollaborationModal:s,game:a}=e,o=window.location.href,r=async()=>{try{await navigator.clipboard.writeText(o),console.log("Link copied to clipboard!")}catch(e){console.error("Failed to copy link:",e)}};return(0,i.jsx)("div",{onClick:()=>t(!1),className:"fixed inset-0 flex h-screen justify-center items-center bg-black/70 z-50",children:(0,i.jsxs)("div",{onClick:e=>e.stopPropagation(),className:"p-6 rounded-lg w-[90vw] md:w-96 bg-gray-100 dark:bg-black h-48 border border-gray-200 dark:border-white/15 shadow-xl tracking-tight flex text-center mx-auto flex-col gap-4",children:[(0,i.jsx)("h1",{className:"font-primary text-xl tracking-tighter text-black dark:text-white font-semibold",children:"Live Collaboration"}),(0,i.jsx)("h3",{className:"text-black dark:text-white",children:"Invite People to colloborate on your drawing"}),(0,i.jsxs)("div",{className:"flex items-stretch justify-between gap-2 p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-[#191919]",children:[(0,i.jsx)("a",{href:o,className:"underline text-sm truncate max-w-[200px] flex items-center text-black dark:text-white",target:"_blank",rel:"noopener noreferrer",children:o}),(0,i.jsx)("div",{className:"border-l border-gray-300 dark:border-gray-600 flex items-center",children:(0,i.jsx)("button",{onClick:r,className:"p-2  rounded transition-colors h-full w-full flex items-center justify-center",title:"Copy link",children:(0,i.jsx)(em.A,{className:"w-5 h-5 text-gray-600 dark:text-gray-400 hover:opacity-70"})})})]})]})})};function ev(e){let{roomId:t,socket:s,session:o}=e,[r,n]=(0,a.useState)(),[l,d]=(0,a.useState)("rect"),{theme:h,toggleTheme:c}=(0,ee.D)(),x=(0,a.useRef)(null),[u,p]=(0,a.useState)(!1),[m,g]=(0,a.useState)({index:-1,shape:void 0}),[v,y]=(0,a.useState)(!1),[f,k]=(0,a.useState)(!1),[b,w]=(0,a.useState)(0),[j,C]=(0,a.useState)(!1),[I,M]=(0,a.useState)(100),[z,P]=(0,a.useState)({x:0,y:0});return(0,a.useEffect)(()=>{null==r||r.setTool(l)},[l]),(0,a.useEffect)(()=>{if(x.current){let e=new N(x.current,t,s,d,o,h,()=>{w(e=>e+1)});return n(e),()=>{e.destroy()}}},[x]),(0,a.useEffect)(()=>{r&&(r.updateTransform(I,z),r.renderCanvas())},[I,z,r]),(0,a.useEffect)(()=>{var e,t;let s=()=>{x.current&&(x.current.width=window.innerWidth,x.current.height=window.innerHeight)};return console.log("Canvas data",null===(e=x.current)||void 0===e?void 0:e.width,null===(t=x.current)||void 0===t?void 0:t.height),s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),(0,a.useEffect)(()=>{if(!r)return;let e=r.clickedShapeIndex,t=r.clickedShape;(e!==m.index||t!==m.shape)&&(console.log("Shape selection changed:",e,t),g({index:e,shape:t}),void 0!==e&&-1!==e?p(!0):p(!1))},[b,r,m.index,m.shape]),(0,a.useEffect)(()=>{if(!r)return;let e="text"===r.selectedTool&&0!==r.text.x&&0!==r.text.y;e!==v&&(console.log("Text input state changed:",e),y(e))},[b,r,v]),Y({canvasRef:x,zoom:I,setZoom:M,panOffset:z,setPanOffset:P,scale:I/100,game:r}),(0,i.jsxs)("div",{className:"h-[100vh] w-full overflow-hidden ".concat("dark"===h?"dark":""),children:[v&&(0,i.jsx)("div",{className:"absolute w-[100px] h-[30px] z-[9999]",style:{top:"".concat(((null==r?void 0:r.text.y)||0)*(I/100)+z.y,"px"),left:"".concat(((null==r?void 0:r.text.x)||0)*(I/100)+z.x,"px")},children:(0,i.jsx)("input",{type:"text",className:"text-2xl focus:outline-none min-w-auto h-full bg-transparent border-none ",style:{fontFamily:"Virgil, sans-serif",fontSize:"".concat(((null==r?void 0:r.fontSize)||24)*(I/100),"px")},autoFocus:!0,ref:e=>{e&&(e.focus(),e.setSelectionRange(0,0))},onChange:e=>{r&&(r.text.text=e.target.value)},onBlur:()=>{r&&(r.sendText(),r.text.text="",r.text.x=0,r.text.y=0)},onKeyDown:e=>{"Enter"===e.key&&r&&(r.sendText(),r.text.text="",r.text.x=0,r.text.y=0)}})}),(0,i.jsx)(et,{game:r,setShowLiveCollaborationModal:C,setShowClearCanvasModal:k}),(0,i.jsx)(S,{selectedTool:l,setSelectedTool:d}),(0,i.jsx)("canvas",{className:"z-[9999]",ref:x}),(0,i.jsx)(T,{zoom:I,onZoomChange:M}),(0,i.jsx)(J,{game:r,clickedShapeIndex:m.index,shape:m.shape,showShapeConfigModal:u,setShowShapeConfigModal:p,canvasUpdateTrigger:b}),f&&(0,i.jsx)(ep,{game:r,setShowClearCanvasModal:k,showClearCanvasModal:f}),j&&(0,i.jsx)(eg,{game:r,setShowLiveCollaborationModal:C,showLiveCollaborationModal:j})]})}var ey=s(3052),ef=s(28293),ek=s(2754);let eb=()=>{let[e,t]=(0,a.useState)(0);(0,a.useEffect)(()=>{let e=setInterval(()=>{t(e=>(e+1)%4)},600);return()=>clearInterval(e)},[]);let s=[{x:-20,y:-20},{x:20,y:-20},{x:20,y:20},{x:-20,y:20}];return(0,i.jsx)("div",{className:"w-screen h-screen dark:bg-black bg-white overflow-hidden",children:(0,i.jsxs)("div",{className:"absolute bottom-20 left-16 flex items-center gap-6",children:[(0,i.jsxs)("div",{className:"relative",children:[(0,i.jsx)(O.P.div,{initial:{x:s[0].x,y:s[0].y},animate:{x:s[e].x,y:s[e].y},transition:{duration:.5,ease:"easeInOut"},className:"absolute",children:(0,i.jsx)(ef.A,{className:"size-10 text-foreground"})}),(0,i.jsx)(O.P.div,{initial:{x:s[1].x,y:s[1].y},animate:{x:s[(e+1)%4].x,y:s[(e+1)%4].y},transition:{duration:.5,ease:"easeInOut"},className:"absolute",children:(0,i.jsx)(ek.A,{className:"size-10 text-foreground"})}),(0,i.jsx)(O.P.div,{initial:{x:s[2].x,y:s[2].y},animate:{x:s[(e+2)%4].x,y:s[(e+2)%4].y},transition:{duration:.5,ease:"easeInOut"},className:"absolute",children:(0,i.jsx)(r.A,{className:"size-10 text-foreground"})}),(0,i.jsx)(O.P.div,{initial:{x:s[3].x,y:s[3].y},animate:{x:s[(e+3)%4].x,y:s[(e+3)%4].y},transition:{duration:.5,ease:"easeInOut"},className:"absolute",children:(0,i.jsx)(l.A,{className:"size-10 text-foreground"})})]}),(0,i.jsx)("div",{className:"text-base font-medium text-foreground/80 tracking-wide"})]})})};function ew(e){let{roomId:t}=e,[s,r]=(0,a.useState)(null),[n,l]=(0,a.useState)(null),[d,h]=(0,a.useState)(!1);return((0,a.useEffect)(()=>{let e;let s=null;(async function(){console.log("session",s=await (0,ey.getSession)()),s&&l(s),e=new WebSocket("".concat(o,"/?token=").concat((null==s?void 0:s.accessToken)||"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6ImI0Y2Q4ZWM3LTM1NWUtNGZlYy04YzNiLWIwYzUyYmU1MTFlMCIsImlhdCI6MTc1MzgwNjQ1NH0.bER-qZ5Lvk39mxILYj8O09aIjFeA5x8A1mST4dLyu7I")),console.log("".concat(o,"/?token=").concat(null==s?void 0:s.accessToken)),e.onopen=()=>{r(e),console.log("conncted ws"),console.log(t),e.send(JSON.stringify({type:"join_room",roomId:t})),setTimeout(()=>{h(!0)},1e3)},e.onclose=()=>{console.log("WebSocket connection closed")}})()},[t]),s&&d)?(0,i.jsx)("div",{children:(0,i.jsx)(ev,{roomId:t,socket:s,session:n})}):(0,i.jsx)(eb,{})}},48180:(e,t,s)=>{"use strict";s.d(t,{D:()=>n,N:()=>r});var i=s(36694),a=s(83286);let o=(0,a.createContext)(void 0);function r(e){let{children:t}=e,[s,r]=(0,a.useState)("dark");return(0,a.useEffect)(()=>{let e=localStorage.getItem("theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;e?r(e):t?r("dark"):r("light")},[]),(0,a.useEffect)(()=>{let e=window.document.documentElement;e.classList.remove("light","dark","system"),e.classList.add(s),localStorage.setItem("theme",s)},[s]),(0,i.jsx)(o.Provider,{value:{theme:s,toggleTheme:()=>{r(e=>"light"===e?"dark":"light")},setSystemTheme:()=>{r(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")}},children:t})}function n(){let e=(0,a.useContext)(o);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[778,589,52,842,909,659,358],()=>t(90178)),_N_E=e.O()}]);